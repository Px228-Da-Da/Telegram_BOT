–¢–ó: Telegram‚Äë–±–æ—Ç ¬´–†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –∑–∞–¥–∞—á¬ª –¥–ª—è —Å—Ç–∞–∂—ë—Ä–æ–≤

> –¶–µ–ª—å: —É–ø—Ä–æ—Å—Ç–∏—Ç—å –≤—ã–¥–∞—á—É, –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –ø—Ä–∏—ë–º–∫—É –∑–∞–¥–∞—á —Å—Ç–∞–∂—ë—Ä–æ–≤ —á–µ—Ä–µ–∑ Telegram –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–µ–±‚Äë–∞–¥–º–∏–Ω–∫–∏. PM –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ —Å—Å—ã–ª–∫–æ–π –Ω–∞ Notion –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏; —Å—Ç–∞–∂—ë—Ä—ã –±–µ—Ä—É—Ç –∑–∞–¥–∞—á–∏, –æ—Ç–º–µ—á–∞—é—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å; —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç—ã.
> 

---

## 1) –ö–æ—Ä–æ—Ç–∫–æ

- **–†–æ–ª–∏:** PM (–∞–¥–º–∏–Ω) –∏ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (—Å—Ç–∞–∂—ë—Ä).
- **–ü—É–±–ª–∏–∫–∞—Ü–∏—è –∑–∞–¥–∞—á:** –æ—Ç–∫—Ä—ã—Ç–∞—è (–≤–∏–¥–Ω–æ –≤—Å–µ–º) –∏–ª–∏ —Ç–æ—á–µ—á–Ω–∞—è (–ø–æ `@username`/deeplink).
- **–°—Ç–∞—Ç—É—Å—ã:** `new ‚Üí taken ‚Üí done` (+ `dropped`, `expired`).
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ª–∏–º–∏—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞.
- **–î–µ–¥–ª–∞–π–Ω—ã:** –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —Å—Ä–æ–∫–æ–º, –∞–≤—Ç–æ‚Äë–ø—Ä–æ—Å—Ä–æ—á–∫–∞.
- **–ê–Ω—Ç–∏–¥—É–±–ª–∏:** –ø–æ `notion_url` (–∏–ª–∏ title+desc) ‚Äî –Ω–µ –¥–∞—ë–º —Å–æ–∑–¥–∞—Ç—å –¥—É–±–ª—å.
- **–≠–∫—Å–ø–æ—Ä—Ç:** CSV –∑–∞ –ø–µ—Ä–∏–æ–¥ –¥–ª—è PM.
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ:** SQLite. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫: APScheduler/asyncio.
- **UX:** —Ç–æ–ª—å–∫–æ inline‚Äë–∫–Ω–æ–ø–∫–∏ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ –¥–∏–∞–ª–æ–≥–∏.

---

## 2) –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (MVP)

### 2.1 –†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø

- PM:
    - –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ (Notion URL + –º–µ—Ç–∞),
    - –≤–∏–¥–∏—Ç –æ—á–µ—Ä–µ–¥–∏/–≤ —Ä–∞–±–æ—Ç–µ/–ø—Ä–æ—Å—Ä–æ—á–∫–∏,
    - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç/–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–¥–∞—á–∏,
    - –≤—ã–≥—Ä—É–∂–∞–µ—Ç CSV,
    - –∏—â–µ—Ç –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É/URL/—é–∑–µ—Ä–Ω–µ–π–º—É.
- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:
    - –≤–∏–¥–∏—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞—á–∏,
    - –≤–∏–¥–∏—Ç ¬´–º–æ–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è¬ª (—Ç–æ—á–µ—á–Ω—ã–µ),
    - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–¥–∞—á—É (`üñê –ü—Ä–∏–Ω—è—Ç—å`),
    - —Å–¥–∞—ë—Ç (`‚úÖ –°–¥–∞—Ç—å`) –∏–ª–∏ –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (`üö´ –û—Ç–∫–∞–∑–∞—Ç—å—Å—è`).

### 2.2 –¢–∏–ø—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

- **–û—Ç–∫—Ä—ã—Ç–∞—è (open):** –∑–∞–¥–∞—á–∞ –≤–∏–¥–Ω–∞ –≤—Å–µ–º —Å—Ç–∞–∂—ë—Ä–∞–º, –∫—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ –ª–∏–º–∏—Ç—É.
- **–¢–æ—á–µ—á–Ω–∞—è (direct):**
    - –ø–æ —Å–ø–∏—Å–∫—É `@username` (–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º), **–∏–ª–∏**
    - –ø–æ **deep‚Äëlink** `t.me/<bot>?start=claim_<token>` (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π —Ç–æ–∫–µ–Ω).

### 2.3 –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –¥–µ–¥–ª–∞–π–Ω—ã

- –ü—Ä–∏ –≤–∑—è—Ç–∏–∏ –∑–∞–¥–∞—á–∏ —Å—Ç–∞–≤—è—Ç—Å—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ `N` –º–∏–Ω—É—Ç –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 60/15/5 ‚Äî –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞).
- –†–∞–∑ –≤ –º–∏–Ω—É—Ç—É —Ñ–æ–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–∫: –≤—Å—ë, —á—Ç–æ –≤—ã—à–ª–æ –∑–∞ –¥–µ–¥–ª–∞–π–Ω –∏ –Ω–µ `done` ‚Üí `expired` —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º PM –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é.

### 2.4 –ê–Ω—Ç–∏–¥—É–±–ª–∏

- –ì–ª–∞–≤–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä: `notion_url` (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏).
- `dedupe_hash = sha1(normalize(notion_url))`.
- –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ (`new`/`taken`) —Å —Ç–µ–º –∂–µ —Ö–µ—à–µ–º ‚Äî –±–ª–æ–∫–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–¥–∞—á—É.

### 2.5 –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- `MAX_ACTIVE_TASKS` ‚Äî –º–∞–∫—Å–∏–º—É–º ¬´—Å–ª–æ—Ç–æ–≤¬ª —É –æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è.
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤–∑—è—Ç—å —Å–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞ ‚Äî –≤–µ–∂–ª–∏–≤—ã–π –æ—Ç–∫–∞–∑.

### 2.6 –≠–∫—Å–ø–æ—Ä—Ç CSV

- –§–æ—Ä–º–∞—Ç –∫–æ–ª–æ–Ω–æ–∫: `id,title,notion_url,assignee_username,status,level,est_hours,deadline,created_at,updated_at`.
- –ü–µ—Ä–∏–æ–¥: –Ω–µ–¥–µ–ª—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–≤–æ–∑–º–æ–∂–µ–Ω –∫–∞—Å—Ç–æ–º –¥–∞—Ç).

### 2.7 –õ–æ–≥–∏/–∞—É–¥–∏—Ç

- –¢–∞–±–ª–∏—Ü–∞ `events` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è: create/take/done/drop/expire/remind/assign/link (—Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏).

---

## 3) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏ (UX)

### 3.1 PM (–∞–¥–º–∏–Ω)

- `/pm` ‚Üí –º–µ–Ω—é: `‚ûï –î–æ–±–∞–≤–∏—Ç—å`, `üìã –û—á–µ—Ä–µ–¥—å`, `‚è≥ –í —Ä–∞–±–æ—Ç–µ`, `üîé –ü–æ–∏—Å–∫`, `üìä –≠–∫—Å–ø–æ—Ä—Ç`.
- `‚ûï –î–æ–±–∞–≤–∏—Ç—å` ‚Äî –º–∞—Å—Ç–µ—Ä:
    1. Notion URL ‚Üí
    2. –ó–∞–≥–æ–ª–æ–≤–æ–∫ ‚Üí
    3. –£—Ä–æ–≤–µ–Ω—å (L1‚ÄìL5 –∏–ª–∏ easy/med/hard) ‚Üí
    4. –û—Ü–µ–Ω–∫–∞ —á–∞—Å–æ–≤ (–æ–ø—Ü.) ‚Üí
    5. –î–µ–¥–ª–∞–π–Ω (+X —á–∞—Å–æ–≤ –∏–ª–∏ –¥–∞—Ç–∞‚Äë–≤—Ä–µ–º—è) ‚Üí
    6. –¢–∏–ø –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: `–û—Ç–∫—Ä—ã—Ç–∞—è` / `–¢–æ—á–µ—á–Ω–∞—è` ‚Üí
    6a) –¥–ª—è `–¢–æ—á–µ—á–Ω–æ–π`: —Å–ø–∏—Å–æ–∫ `@username` **–∏–ª–∏** —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å deep‚Äëlink.
- `üìã –û—á–µ—Ä–µ–¥—å` ‚Äî —Å–ø–∏—Å–æ–∫ `new` —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –∑–∞–¥–∞—á (–∫–Ω–æ–ø–∫–∏: `üóë –£–¥–∞–ª–∏—Ç—å`, ¬´–ü–æ–∫–∞–∑–∞—Ç—å –¥—É–±–ª—å¬ª –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ).
- `‚è≥ –í —Ä–∞–±–æ—Ç–µ` ‚Äî —É –∫–æ–≥–æ —á—Ç–æ –≤–∑—è—Ç–æ, –¥–æ –∫–∞–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.
- `üîé –ü–æ–∏—Å–∫` ‚Äî –ø–æ —á–∞—Å—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞/URL/—é–∑–µ—Ä–Ω–µ–π–º—É.
- `üìä –≠–∫—Å–ø–æ—Ä—Ç` ‚Äî –∫–Ω–æ–ø–∫–∏ `–ù–µ–¥–µ–ª—è / –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥`, –æ—Ç–¥–∞—ë–º CSV —Ñ–∞–π–ª–æ–º.

### 3.2 –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (—Å—Ç–∞–∂—ë—Ä)

- `/start` ‚Üí –º–µ–Ω—é: `üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ`, `üéØ –ú–æ–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è`, `üë§ –ú–æ–∏ –∑–∞–¥–∞—á–∏`, `‚ùì –ü–æ–º–æ—â—å`.
- `üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ` ‚Äî —Ç–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ `new`.
- `üéØ –ú–æ–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è` ‚Äî —Ç–æ—á–µ—á–Ω—ã–µ (–ø–æ username/deeplink), –∫–Ω–æ–ø–∫–∞ `üñê –ü—Ä–∏–Ω—è—Ç—å`.
- `üë§ –ú–æ–∏ –∑–∞–¥–∞—á–∏` ‚Äî —Å–ø–∏—Å–æ–∫ `taken`: `‚úÖ –°–¥–∞—Ç—å`, `üö´ –û—Ç–∫–∞–∑–∞—Ç—å—Å—è`.
- –ü—Ä–∏ `‚úÖ –°–¥–∞—Ç—å` PM –ø–æ–ª—É—á–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É ¬´–ü—Ä–∏–Ω—è—Ç—å/–í–µ—Ä–Ω—É—Ç—å¬ª. –ü—Ä–∏–Ω—è—Ç–∏–µ ‚Üí `done`. –í–æ–∑–≤—Ä–∞—Ç –æ—Å—Ç–∞–≤–ª—è–µ—Ç `taken` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Å –∫–æ–º–º–µ–Ω—Ç–æ–º).

---

## 4) –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–¥–∞—á–∏

`new` (—Å–æ–∑–¥–∞–Ω–æ) ‚Üí `taken` (–∫—Ç–æ‚Äë—Ç–æ –ø—Ä–∏–Ω—è–ª) ‚Üí `done` (–ø—Ä–∏–Ω—è—Ç–æ PM)
–î–æ–ø. –ø–µ—Ä–µ—Ö–æ–¥—ã:

- `taken ‚Üí dropped` (–æ—Ç–∫–∞–∑ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è) ‚Üí –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –ø–æ–ª–∏—Ç–∏–∫–µ (—Å–º. –∫–æ–Ω—Ñ–∏–≥),
- `new|taken ‚Üí expired` (–ø—Ä–æ—Å—Ä–æ—á–∫–∞),
- `new ‚Üí new` (–ø–æ–ø—ã—Ç–∫–∞ –¥—É–±–ª—è ‚Äî –±–ª–æ–∫–∏—Ä—É–µ–º).
**–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –≤–∑—è—Ç–∏—è:** —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è `BEGIN IMMEDIATE` –≤ SQLite; –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `status='taken', assigned_to=user_id, updated_at=now()` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å `new`.

---

## 5) –•—Ä–∞–Ω–∏–ª–∏—â–µ (SQLite)

```sql
-- users
CREATE TABLE IF NOT EXISTS users(
  id INTEGER PRIMARY KEY,
  tg_id INTEGER UNIQUE NOT NULL,
  username TEXT,
  full_name TEXT,
  role TEXT CHECK(role IN ('pm','exec')) NOT NULL,
  is_active INTEGER DEFAULT 1
);
-- tasks
CREATE TABLE IF NOT EXISTS tasks(
  id INTEGER PRIMARY KEY,
  title TEXT NOT NULL,
  notion_url TEXT NOT NULL,
  level TEXT,
  est_hours REAL,
  publish_mode TEXT CHECK(publish_mode IN ('open','direct')) NOT NULL,
  deadline_ts INTEGER,
  status TEXT CHECK(status IN ('new','taken','done','dropped','expired')) DEFAULT 'new',
  assigned_to INTEGER,
  created_by INTEGER NOT NULL,
  allowed_usernames TEXT,          -- JSON array —Å—Ç—Ä–æ–∫
  dedupe_hash TEXT,                -- sha1(notion_url)
  created_at INTEGER,
  updated_at INTEGER
);
CREATE UNIQUE INDEX IF NOT EXISTS idx_tasks_notion_active
ON tasks(dedupe_hash)
WHERE status IN ('new','taken');
-- events (–∞—É–¥–∏—Ç)
CREATE TABLE IF NOT EXISTS events(
  id INTEGER PRIMARY KEY,
  ts INTEGER,
  actor_id INTEGER,
  action TEXT,
  task_id INTEGER,
  meta TEXT
);

```

---

## 6) –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`config.py`)

```python
BOT_TOKEN = "..."
PM_IDS = {123456789}              # tg_id –∞–¥–º–∏–Ω–æ–≤
MAX_ACTIVE_TASKS = 1              # –ª–∏–º–∏—Ç —Å–ª–æ—Ç–æ–≤ –Ω–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
REMINDERS_MIN = [60, 15, 5]       # –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –¥–µ–¥–ª–∞–π–Ω–æ–º
EXPIRE_SCAN_INTERVAL = 60         # —Å–µ–∫, —Ñ–æ–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–∫
DIRECT_REOPEN_POLICY = "same"    # 'same' | 'open' –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –∏–∑ direct
DB_PATH = "./data/bot.db"
EXPORT_DIR = "./exports"
DEEP_LINK_SECRET = "change_me"   # –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ —Ç–æ–∫–µ–Ω–æ–≤
TIMEZONE = "Europe/Kyiv"

```

---

## 7) –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–°—Ç–µ–∫:** Python 3.11+, aiogram v3, SQLite, APScheduler (–∏–ª–∏ —á–∏—Å—Ç—ã–π asyncio‚Äë—Ç–∞–π–º–µ—Ä—ã).
- **Deeplink‚Äë—Ç–æ–∫–µ–Ω:** `token = base64url(HMAC_SHA256(f"{task_id}:{exp}", SECRET)) + "." + task_id + "." + exp`.
- **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞:**
    - –±–∞–∑–∞ ‚Äî –Ω–∞ –¥–∏—Å–∫–µ;
    - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞: —Å—Ç–∞–≤–∏—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –¥–ª—è `taken` —Å –±—É–¥—É—â–∏–º–∏ –¥–µ–¥–ª–∞–π–Ω–∞–º–∏;
    - –æ—Ç–¥–µ–ª—å–Ω–∞—è –º–∏–Ω—É—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –º–µ—Ç–∏—Ç –ø—Ä–æ—Å—Ä–æ—á–∫–∏ ‚Äî —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–∂–µ –±–µ–∑ ¬´–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏¬ª –≤—Å–µ—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤.
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º—ë–Ω:** –≤–µ–∑–¥–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å `@username`; –≤ –±–∞–∑–µ —Ö—Ä–∞–Ω–∏—Ç—å `tg_id` + –ø–æ—Å–ª–µ–¥–Ω–∏–π `username`.
- **–õ–æ–∫–∞–ª—å/–≤—Ä–µ–º—è:** —Ö—Ä–∞–Ω–∏—Ç—å epoch (UTC), –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ª–æ–∫–∞–ª—å–Ω–æ (TIMEZONE).

---

## 8) –ö–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏

- –ö–æ–º–∞–Ω–¥—ã: `/start`, `/help` ‚Äî –¥–ª—è –≤—Å–µ—Ö; `/pm` ‚Äî —Ç–æ–ª—å–∫–æ PM.
- –ò–Ω–ª–∞–π–Ω‚Äë–º–µ–Ω—é PM: `‚ûï –î–æ–±–∞–≤–∏—Ç—å`, `üìã –û—á–µ—Ä–µ–¥—å`, `‚è≥ –í —Ä–∞–±–æ—Ç–µ`, `üîé –ü–æ–∏—Å–∫`, `üìä –≠–∫—Å–ø–æ—Ä—Ç`.
- –ò–Ω–ª–∞–π–Ω‚Äë–º–µ–Ω—é –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: `üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ`, `üéØ –ú–æ–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è`, `üë§ –ú–æ–∏ –∑–∞–¥–∞—á–∏`.
- –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –∑–∞–¥–∞—á–∏: `üñê –ü—Ä–∏–Ω—è—Ç—å`, `‚úÖ –°–¥–∞—Ç—å`, `üö´ –û—Ç–∫–∞–∑–∞—Ç—å—Å—è`.
- –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å–¥–∞—á–∏ (–¥–ª—è PM): `‚úÖ –ü—Ä–∏–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É`, `‚ùå –í–µ—Ä–Ω—É—Ç—å`.

---

## 9) –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å:** –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–¥–µ–Ω–∏–π –≤ —á–∞—Ç; –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è ‚Äî –≤ –ª–æ–≥–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞:** –±–µ–∑ ORM –∏ –ª–∏—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π; —á–∏—Å—Ç—ã–µ SQL‚Äë–∑–∞–ø—Ä–æ—Å—ã.
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –≤ —Ä–∞–º–∫–∞—Ö —á–∞—Ç–∞ ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã; –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –º–∏–Ω—É—Ç—ã.
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ø–æ–¥–ø–∏—Å—å deeplink‚Äë—Ç–æ–∫–µ–Ω–æ–≤ HMAC; –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –ª–∏—à–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ; –¥–æ—Å—Ç—É–ø PM –ø–æ —Å–ø–∏—Å–∫—É `PM_IDS`.
- **–§–∞–π–ª—ã:** –ë–î ‚Äî `./data/bot.db`; —ç–∫—Å–ø–æ—Ä—Ç—ã ‚Äî `./exports/*.csv`.

---

## 10) –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—á—Ç–æ–±—ã —É–ª–æ–∂–∏—Ç—å—Å—è –≤ \~8 —á–∞—Å–æ–≤)

- –ë–µ–∑ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ñ–æ—Ä–º –≤–≤–æ–¥–∞ (–ø–æ—à–∞–≥–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ –æ–∫).
- –ë–µ–∑ –ø—Ä–æ–¥–ª–µ–Ω–∏—è –¥–µ–¥–ª–∞–π–Ω–∞ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ).
- –û–¥–∏–Ω —è–∑—ã–∫ (RU), –æ–¥–Ω–∞ —Ç–∞–π–º–∑–æ–Ω–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞.
- –ü–æ–∏—Å–∫ ‚Äî –ø—Ä–æ—Å—Ç–æ–π (LIKE –ø–æ title/url/username).

---

## 11) –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ (—Å—Ç—Ä–æ–≥–æ)

- [ ]  –†–æ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç: PM –≤–∏–¥–∏—Ç –∞–¥–º–∏–Ω‚Äë–º–µ–Ω—é, —Å—Ç–∞–∂—ë—Ä ‚Äî –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–µ.
- [ ]  –ê–Ω—Ç–∏–¥—É–±–ª–∏ –ø–æ `notion_url`: –¥—É–±–ª—å –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–µ–ª—å–∑—è.
- [ ]  –õ–∏–º–∏—Ç —Å–ª–æ—Ç–æ–≤ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è: –Ω–µ–ª—å–∑—è –≤–∑—è—Ç—å > `MAX_ACTIVE_TASKS`.
- [ ]  –í–∑—è—Ç–∏–µ –∑–∞–¥–∞—á–∏ –∞—Ç–æ–º–∞—Ä–Ω–æ: –¥–≤–∞ –∫–ª–∏–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –¥–∞—é—Ç –¥–≤–æ–π–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.
- [ ]  –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∑–∞ –º–∏–Ω—É—Ç—ã –∏–∑ `REMINDERS_MIN` –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞.
- [ ]  –ü—Ä–æ—Å—Ä–æ—á–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏—Ç `expired` –∏ —à–ª—ë—Ç PM + –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é.
- [ ]  –°–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è PM: `done` —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ ¬´–ü—Ä–∏–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É¬ª.
- [ ]  –≠–∫—Å–ø–æ—Ä—Ç CSV —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è PM, –∫–æ–ª–æ–Ω–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- [ ]  –ü–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞: –±–∞–∑–∞ –Ω–∞ –º–µ—Å—Ç–µ, –ø—Ä–æ—Å—Ä–æ—á–∫–∏ –º–µ—Ç—è—Ç—Å—è, –±—É–¥—É—â–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞–Ω–æ–≤–æ —Å—Ç–∞–≤—è—Ç—Å—è.
- [ ]  –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è `@username`, –Ω–µ ¬´—Å—ã—Ä–æ–π¬ª `tg_id`.
- [ ]  README —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π/–∑–∞–ø—É—Å–∫–æ–º –∏ —Ç–µ—Å—Ç‚Äë—Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

---

## 12) –¢–µ—Å—Ç‚Äë—Å—Ü–µ–Ω–∞—Ä–∏–∏ (—Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, 10‚Äì15 –º–∏–Ω—É—Ç)

1. –°–æ–∑–¥–∞—Ç—å 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–¥–∞—á–∏ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–π Notion URL) ‚Üí –≤—Ç–æ—Ä–∞—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Å –∫–Ω–æ–ø–∫–æ–π ¬´–ü–æ–∫–∞–∑–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é¬ª.
2. –°—Ç–∞–∂—ë—Ä –±–µ—Ä—ë—Ç 1 –∑–∞–¥–∞—á—É –ø—Ä–∏ `MAX_ACTIVE_TASKS=1` ‚Üí –ø–æ–ø—ã—Ç–∫–∞ –≤–∑—è—Ç—å –≤—Ç–æ—Ä—É—é ‚Äî –æ—Ç–∫–∞–∑.
3. –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É —Å –¥–µ–¥–ª–∞–π–Ω–æ–º +6 –º–∏–Ω—É—Ç ‚Üí –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç.
4. –ù–µ —Å–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á—É –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞ ‚Üí —Å—Ç–∞—Ç—É—Å `expired`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —É—Ö–æ–¥—è—Ç PM –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é.
5. –°—Ç–∞–∂—ë—Ä —Å–¥–∞—ë—Ç –∑–∞–¥–∞—á—É ‚Üí PM –ø—Ä–∏–Ω–∏–º–∞–µ—Ç ‚Üí —Å—Ç–∞—Ç—É—Å `done`.
6. –í—ã–≥—Ä—É–∑–∏—Ç—å CSV –∑–∞ –Ω–µ–¥–µ–ª—é ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è.

---

## 13) –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–∞ –≤—Ö–æ–¥

- `BOT_TOKEN`, —Å–ø–∏—Å–æ–∫ `PM_IDS` (tg\_id –∞–¥–º–∏–Ω–æ–≤).
- `DEEP_LINK_SECRET` (—Å—Ç—Ä–æ–∫–∞ –¥–ª—è HMAC –ø–æ–¥–ø–∏—Å–∏).
- –¢–∞–π–º–∑–æ–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `Europe/Kyiv`).
- –ü–∞–ø–∫–∏ `./data` –∏ `./exports` —Å –ø—Ä–∞–≤–∞–º–∏ –∑–∞–ø–∏—Å–∏.

---

## 14) –û—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç (—Ü–µ–ª—å ‚Äî 8 —á–∞—Å–æ–≤)

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞, –ë–î, –∫–æ–Ω—Ñ–∏–≥: **1—á**
- –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: **0.5—á**
- –ú–∞—Å—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á (PM) + –∞–Ω—Ç–∏–¥—É–±–ª–∏: **1.5—á**
- –°–ø–∏—Å–∫–∏/–≤–∑—è—Ç–∏–µ/–ª–∏–º–∏—Ç—ã/¬´–ú–æ–∏ –∑–∞–¥–∞—á–∏¬ª: **1.5—á**
- –°–¥–∞—á–∞/–º–æ–¥–µ—Ä–∞—Ü–∏—è/—Å—Ç–∞—Ç—É—Å—ã/—Å–æ–±—ã—Ç–∏—è: **0.5—á**
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è/–ø—Ä–æ—Å—Ä–æ—á–∫–∞/–æ—Ç—á—ë—Ç: **1.5—á**
- –≠–∫—Å–ø–æ—Ä—Ç CSV: **0.5—á**
- README –∏ –ø—Ä–æ–≥–æ–Ω—ã: **1—á**

---

## 15) –†–∞—Å—à–∏—Ä–µ–Ω–∏—è (–ø–æ—Å–ª–µ MVP)

- –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–∞ –∑–∞—è–≤–∫–æ–π –æ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (–æ–¥–æ–±—Ä—è–µ—Ç PM).
- –§–∏–ª—å—Ç—Ä—ã —ç–∫—Å–ø–æ—Ä—Ç–∞ (–ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é/—Å—Ç–∞—Ç—É—Å—É/–¥–∞—Ç–∞–º).
- –ê–≤—Ç–æ–ø–∏–Ω–≥ ¬´–≤–∏—Å—è—â–∏—Ö¬ª `new` –∑–∞–¥–∞—á —Å—Ç–∞—Ä—à–µ N —á–∞—Å–æ–≤.
- –ú–µ—Ç—Ä–∏–∫–∏: –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏/–∫–∞—á–µ—Å—Ç–≤—É.

---

## 16) –ì–ª–æ—Å—Å–∞—Ä–∏–π

- **PM** ‚Äî —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å/–∞–¥–º–∏–Ω, –∫—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–¥–∞—á–∏.
- **–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å** ‚Äî —Å—Ç–∞–∂—ë—Ä, –∫—Ç–æ –±–µ—Ä—ë—Ç –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á–∏.
- **–û—Ç–∫—Ä—ã—Ç–∞—è –∑–∞–¥–∞—á–∞** ‚Äî –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º —Å—Ç–∞–∂—ë—Ä–∞–º.
- **–¢–æ—á–µ—á–Ω–∞—è –∑–∞–¥–∞—á–∞** ‚Äî –¥–æ—Å—Ç—É–ø–Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–º —é–∑–µ—Ä–Ω–µ–π–º–∞–º –∏–ª–∏ –ø–æ deeplink.
- **Deeplink** ‚Äî —Å—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Å—ã–ª–∫–∞ Telegram —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, –¥–∞—é—â–∞—è –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ.
- **–°–ª–æ—Ç** ‚Äî –∞–∫—Ç–∏–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ —É —Å—Ç–∞–∂—ë—Ä–∞; –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è `MAX_ACTIVE_TASKS`.






–¢–µ—Ö–ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (8 —á–∞—Å–æ–≤): Telegram‚Äë–±–æ—Ç ¬´–†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å –∑–∞–¥–∞—á¬ª

> –¶–µ–ª—å: –∑–∞ –æ–¥–∏–Ω —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å —Å–æ–±—Ä–∞—Ç—å MVP –±–æ—Ç–∞ –Ω–∞ aiogram v3 + SQLite —Å —Ä–æ–ª—è–º–∏ PM/–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –æ—á–µ—Ä–µ–¥—å—é –∑–∞–¥–∞—á (open/direct), –∞–Ω—Ç–∏–¥—É–±–ª—è–º–∏, –ª–∏–º–∏—Ç–æ–º —Å–ª–æ—Ç–æ–≤, –¥–µ–¥–ª–∞–π–Ω–∞–º–∏/–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç–æ–º CSV.
> 

---

## 0) –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (0.2 —á)

- Python 3.11+, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.
- –ü–∞–∫–µ—Ç—ã: `aiogram==3.*`, `apscheduler==3.*`, `python-dateutil`.
- –°–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –∫–∞—Ä–∫–∞—Å –ø—Ä–æ–µ–∫—Ç–∞.

```
project/
  bot.py
  config.py
  db.py
  scheduler.py
  keyboards.py
  handlers/
    common.py
    pm.py
    exec.py
  services/
    tasks.py
    direct.py
    export.py
    reminders.py
  utils/
    hash.py
    time.py
  data/.gitkeep
  exports/.gitkeep
  README.md

```

---

## 1) –ë–î –∏ —É—Ç–∏–ª–∏—Ç—ã (1.0 —á)

**–¶–µ–ª—å:** —Ä–∞–±–æ—á–∞—è SQLite, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, —Ö–µ—à–∏, –≤—Ä–µ–º—è, –∞—É–¥–∏—Ç.

- `db.py`: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, `init_db()`; SQL‚Äë—Å—Ö–µ–º–∞:
    - `users(id, tg_id UNIQUE, username, full_name, role CHECK('pm'|'exec'), is_active)`
    - `tasks(id, title, notion_url, level, est_hours, publish_mode CHECK('open'|'direct'), deadline_ts, status CHECK('new'|'taken'|'done'|'dropped'|'expired') DEFAULT 'new', assigned_to, created_by, allowed_usernames JSON, dedupe_hash, created_at, updated_at)`
    - `events(id, ts, actor_id, action, task_id, meta)`
    - `UNIQUE INDEX idx_tasks_notion_active (dedupe_hash) WHERE status IN ('new','taken')`
- `utils/hash.py`: `dedupe_hash(url)` ‚Üí `sha1(normalize(url))`.
- `utils/time.py`: `now()`, `to_ts()`, `from_ts()`, `humanize_ts()`, TIMEZONE=`Europe/Kyiv`.
- Smoke‚Äë—Ç–µ—Å—Ç: `init_db()` —Å–æ–∑–¥–∞—ë—Ç `data/bot.db`.

---

## 2) –ë–∞–∑–æ–≤—ã–π –±–æ—Ç –∏ —Ä–æ–ª–∏ (0.5 —á)

**–¶–µ–ª—å:** /start —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ–Ω—é.

- `config.py`: –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `BOT_TOKEN`, `PM_IDS`, `MAX_ACTIVE_TASKS`, `REMINDERS_MIN`, `EXPIRE_SCAN_INTERVAL`, `DIRECT_REOPEN_POLICY`, `DB_PATH`, `EXPORT_DIR`, `DEEP_LINK_SECRET`, `TIMEZONE`.
- `bot.py`: Dispatcher, —Ä–æ—É—Ç–µ—Ä—ã `common/pm/exec`, middleware –ª–æ–≥–æ–≤.
- `handlers/common.py`: `/start`, `/help`.
    - Upsert –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (tg_id, username, full_name, —Ä–æ–ª—å –ø–æ `PM_IDS`).
    - –í—ã–≤–æ–¥ –∏–Ω–ª–∞–π–Ω‚Äë–º–µ–Ω—é.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –≤ `/pm`.

---

## 3) –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á (PM) + –∞–Ω—Ç–∏–¥—É–±–ª–∏ (1.5 —á)

**–¶–µ–ª—å:** –º–∞—Å—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å Notion URL, —É—Ä–æ–≤–Ω–µ–º, –¥–µ–¥–ª–∞–π–Ω–æ–º, —Ç–∏–ø–æ–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.

- `keyboards.py`: –∏–Ω–ª–∞–π–Ω—ã –º–∞—Å—Ç–µ—Ä–∞ –∏ –∫–∞—Ä—Ç–æ—á–µ–∫.
- `handlers/pm.py` ‚Üí `‚ûï –î–æ–±–∞–≤–∏—Ç—å` (–ø–æ—à–∞–≥–æ–≤–æ):
    1. `notion_url` (–æ–±—è–∑.) ‚Üí
    2. `title` ‚Üí
    3. `level (L1‚ÄìL5 / easy|med|hard)` ‚Üí
    4. `est_hours` (–æ–ø—Ü.) ‚Üí
    5. `deadline` (`+Xh/+Xm` –∏–ª–∏ `YYYY-MM-DD HH:MM`) ‚Üí
    6. `publish_mode`: `open` –∏–ª–∏ `direct` ‚Üí
        
        6a) –¥–ª—è `direct`: —Å–ø–∏—Å–æ–∫ `@username` **–∏–ª–∏** –≥–µ–Ω–µ—Ä–∞—Ü–∏—è **deeplink**.
        
- –ü—Ä–∏ —Å–∞–±–º–∏—Ç–µ: `dedupe_hash(notion_url)`; –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö; –∑–∞–ø–∏—Å—å `tasks`, —Å–æ–±—ã—Ç–∏–µ `events.create`.
- `services/direct.py`: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ deeplink‚Äë—Ç–æ–∫–µ–Ω–∞ (`claim_<token>`), —Å–æ–±—ã—Ç–∏–µ `events.link`.

---

## 4) –°–ø–∏—Å–∫–∏, –≤–∑—è—Ç–∏–µ, —Å–ª–æ—Ç—ã (1.5 —á)

**–¶–µ–ª—å:** —Å—Ç–∞–∂—ë—Ä –≤–∏–¥–∏—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏, –º–æ–∂–µ—Ç –ø—Ä–∏–Ω—è—Ç—å —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ª–∏–º–∏—Ç–∞.

- `handlers/exec.py`:
    - `üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ` ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∏ `new/open`.
    - `üéØ –ú–æ–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è` ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∏ `new/direct`, –≥–¥–µ username —Å–æ–≤–ø–∞–¥–∞–µ—Ç **–∏–ª–∏** —Å—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ deeplink `/start claim_<token>`.
    - `üë§ –ú–æ–∏ –∑–∞–¥–∞—á–∏` ‚Üí —Å–ø–∏—Å–æ–∫ `taken` —Å `‚úÖ –°–¥–∞—Ç—å` / `üö´ –û—Ç–∫–∞–∑–∞—Ç—å—Å—è`.
- `services/direct.py`: `validate_token(token) -> task_id|None` (–ø–æ–¥–ø–∏—Å—å HMAC + expiry + —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏).
- `services/tasks.py`:
    - `active_slots_count(user_id)`.
    - `try_take_task(task_id, user_id)` ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è `BEGIN IMMEDIATE`; –∞–ø–¥–µ–π—Ç, –µ—Å–ª–∏ `status='new'`; —Å–æ–±—ã—Ç–∏–µ `take`.
    - `drop_task(task_id, user_id)` ‚Äî `taken‚Üídropped`, —Ä–µ–ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ `DIRECT_REOPEN_POLICY` (`same|open`).
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤: –¥–æ –∞–ø–¥–µ–π—Ç–∞ —Å–≤–µ—Ä—è—Ç—å —Å `MAX_ACTIVE_TASKS`.

---

## 5) –°–¥–∞—á–∞ –∏ –ø—Ä–∏—ë–º–∫–∞ PM (0.5 —á)

**–¶–µ–ª—å:** —Å–¥–∞—á–∞ —Å –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π —É PM.

- –°—Ç–∞–∂—ë—Ä –∂–º—ë—Ç `‚úÖ –°–¥–∞—Ç—å` ‚Üí PM –ø–æ–ª—É—á–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É ¬´–ü—Ä–∏–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É / –í–µ—Ä–Ω—É—Ç—å¬ª (–æ–ø—Ü. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π).
- `services/tasks.py`:
    - `mark_done(task_id, pm_id)` ‚Üí `taken‚Üídone`, `events.done`.
    - `return_submission(task_id, pm_id, reason)` ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è `taken`, `events` —Å `reason`.

---

## 6) –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –ø—Ä–æ—Å—Ä–æ—á–∫–∏, –æ—Ç—á—ë—Ç (1.5 —á)

**–¶–µ–ª—å:** –ø–∏–Ω–≥–∏ –ø–µ—Ä–µ–¥ –¥–µ–¥–ª–∞–π–Ω–æ–º –∏ –∞–≤—Ç–æ‚Äë–ø—Ä–æ—Å—Ä–æ—á–∫–∞.

- `scheduler.py`:
    - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å APScheduler.
    - –ù–∞ —Å—Ç–∞—Ä—Ç–µ: –¥–ª—è –≤—Å–µ—Ö `taken` —Å –±—É–¥—É—â–∏–º–∏ –¥–µ–¥–ª–∞–π–Ω–∞–º–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ—á–µ—á–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (`deadline - REMINDERS_MIN[i]`).
    - –ú–∏–Ω—É—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞: –≤—Å–µ `new|taken` —Å `deadline_ts < now()` ‚Üí `expired`; —É–≤–µ–¥–æ–º–∏—Ç—å PM –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è; `events.expire`.
    - (–û–ø—Ü.) –í–µ—á–µ—Ä–Ω–∏–π –æ—Ç—á—ë—Ç PM –ø–æ `TIMEZONE`: `new/taken/done/expired` –∑–∞ —Å—É—Ç–∫–∏.
- `services/reminders.py`: `schedule_reminders(task)`, `send_reminder(task, minutes_left)`; `events.remind`.

---

## 7) –≠–∫—Å–ø–æ—Ä—Ç CSV (0.5 —á)

**–¶–µ–ª—å:** –≤—ã–≥—Ä—É–∑–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é –ø–æ –∫–Ω–æ–ø–∫–µ PM.

- `services/export.py`: `export_week(conn, path)` ‚Üí CSV —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: `id,title,notion_url,assignee_username,status,level,est_hours,deadline,created_at,updated_at`.
- `handlers/pm.py`: `üìä –≠–∫—Å–ø–æ—Ä—Ç` ‚Üí —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤ `exports/` –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º.

---

## 8) –¢–µ—Å—Ç‚Äë–ø—Ä–æ–≥–æ–Ω –∏ README (0.8 —á)

**–¶–µ–ª—å:** –ø—Ä–æ–π—Ç–∏ —á–µ–∫‚Äë–ª–∏—Å—Ç –ø—Ä–∏—ë–º–∫–∏ –∏ –æ–ø–∏—Å–∞—Ç—å –∑–∞–ø—É—Å–∫.

- –†—É—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (—Å–º. –¢–ó): –¥—É–±–ª—å, —Å–ª–æ—Ç—ã, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –ø—Ä–æ—Å—Ä–æ—á–∫–∞, —Å–¥–∞—á–∞/–ø—Ä–∏—ë–º–∫–∞, —ç–∫—Å–ø–æ—Ä—Ç.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è `@username` –≤–µ–∑–¥–µ, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ¬´Traceback –≤ —á–∞—Ç¬ª.
- `README.md`: —É—Å—Ç–∞–Ω–æ–≤–∫–∞, –∑–∞–ø—É—Å–∫, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ/–∫–æ–Ω—Ñ–∏–≥, –∫–æ–º–∞–Ω–¥—ã, —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏.

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

- **T+2—á** ‚Äî –ë–î, —Ä–æ–ª–∏, –º–µ–Ω—é, –º–∞—Å—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–µ–∑ direct.
- **T+4—á** ‚Äî –°–ø–∏—Å–∫–∏/–≤–∑—è—Ç–∏–µ/—Å–ª–æ—Ç—ã/–∞–Ω—Ç–∏–¥—É–±–ª–∏, –±–∞–∑–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç.
- **T+6—á** ‚Äî –°–¥–∞—á–∞/–ø—Ä–∏—ë–º–∫–∞, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –ø—Ä–æ—Å—Ä–æ—á–∫–∞.
- **T+8—á** ‚Äî –¢–µ—Å—Ç—ã, README, –∑–∞—á–∏—Å—Ç–∫–∞ —É–≥–ª–æ–≤.

---

## –†–∏—Å–∫–∏ –∏ –∫–∞–∫ —Ä–µ–∂–µ–º —É–≥–ª—ã

- **–ü–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏:** –ø—Ä–∏–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ `+Xh/+Xm` –∏ `YYYY-MM-DD HH:MM`; –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –æ—Ç–∫–∞–∑ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π.
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:** –µ—Å–ª–∏ –Ω–µ —É—Å–ø–µ–≤–∞–µ–º —Å APScheduler ‚Äî –¥–µ–ª–∞–µ–º –º–∏–Ω—É—Ç–Ω—ã–π —Å–∫–∞–Ω + `asyncio.create_task` –¥–ª—è –±–ª–∏–∂–∞–π—à–∏—Ö –ø–∏–Ω–≥–æ–≤.
- **Deeplink:** –∫–æ—Ä–æ—Ç–∫–∏–π TTL (–Ω–∞–ø—Ä–∏–º–µ—Ä, 24—á), –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ—Å—Ç—å —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ñ–ª–∞–≥–æ–º/—Å–æ–±—ã—Ç–∏–µ–º.
- **–ì–æ–Ω–∫–∏/–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å:** —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ `try_take_task` + `UNIQUE INDEX` –ø–æ `dedupe_hash`.

---

## Definition of Done (—á–µ–∫‚Äë–ª–∏—Å—Ç)

- [ ]  `/pm` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ `PM_IDS`; –º–µ–Ω—é —É —Ä–æ–ª–µ–π —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è.
- [ ]  –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å `notion_url`; –¥—É–±–ª—å –∞–∫—Ç–∏–≤–Ω–æ–π –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.
- [ ]  `open` –≤–∏–¥–Ω–∞ –≤—Å–µ–º; `direct` ‚Äî —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–∞—Ç–∞–º/–ø–æ –≤–∞–ª–∏–¥–Ω–æ–º—É deeplink.
- [ ]  –í–∑—è—Ç–∏–µ –∑–∞–¥–∞—á–∏ –∞—Ç–æ–º–∞—Ä–Ω–æ; –ª–∏–º–∏—Ç —Å–ª–æ—Ç–æ–≤ —Å–æ–±–ª—é–¥—ë–Ω.
- [ ]  –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∑–∞ –≤—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –∏–∑ `REMINDERS_MIN`.
- [ ]  –ü—Ä–æ—Å—Ä–æ—á–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏—Ç `expired` –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç PM + –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è.
- [ ]  –°–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è PM; `done` —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ ¬´–ü—Ä–∏–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É¬ª.
- [ ]  –≠–∫—Å–ø–æ—Ä—Ç CSV –∑–∞ –Ω–µ–¥–µ–ª—é —Å —Ç–æ—á–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏.
- [ ]  –ü–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞: –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã; –ø—Ä–æ—Å—Ä–æ—á–∫–∏ –º–µ—Ç—è—Ç—Å—è; –±—É–¥—É—â–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.
- [ ]  –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è `@username`, –Ω–µ `tg_id`.
- [ ]  README –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —à–∞–≥–∏ –∑–∞–ø—É—Å–∫–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã.

---

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
python -m venv .venv && source .venv/bin/activate
pip install aiogram apscheduler python-dateutil
python -c "import db; db.init_db()"
# –ø—Ä–æ–ø–∏—Å–∞—Ç—å BOT_TOKEN –∏ PM_IDS –≤ config.py
python bot.py

```

---

## –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞ —Å–¥–∞—á—É

- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∫–æ–¥–æ–º + `README.md`.
- `data/bot.db` (–∏–ª–∏ SQL‚Äë–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä).
- –ü—Ä–∏–º–µ—Ä `config.py` (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞).
- CSV‚Äë—ç–∫—Å–ø–æ—Ä—Ç –∑–∞ –Ω–µ–¥–µ–ª—é (–ø—Ä–∏–º–µ—Ä).
- –°–ø–∏—Å–æ–∫ `PM_IDS` –∏ `DEEP_LINK_SECRET` (–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏).